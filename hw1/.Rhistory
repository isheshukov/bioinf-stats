samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = len(birth1 + birth2) - sum(birth1 + birth2), size = length(birth1[birth1 == 0]), prob = p_grid)
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = length(birth1 + birth2) - sum(birth1 + birth2), size = length(birth1[birth1 == 0]), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1[birth1 == 0]), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1 == 0), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
#likelihood <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
#likelihood <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
samples <- sample(x = p_grid, size = 10000, prob = posterior, replace = TRUE)
posterior <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
hist(posterior)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
posterior2 <- rbinom(n = 10000, size = length(birth1), prob = samples)
hist(posterior1)
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = length(birth1) - sum(birth1), size = length(birth1), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
posterior2 <- rbinom(n = 10000, size = length(birth1), prob = samples)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples)
posterior2 <- rbinom(n = 10000, size = length(birth1), prob = samples)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(c(birth1, birth2)), prob = samples2)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(c(birth1)), prob = samples2)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(birth1), prob = samples2)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(c(birth1, birth2)), prob = samples2)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1)
abline(v = sum(boys_after_girls))
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1)
par(new=TRUE)
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1)
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
dens(posterior1)
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1)
hist(posterior2)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1)
hist(posterior2, add=T)
abline(v = sum(boys_after_girls))
boys_after_girls <- birth2[birth1 == 0]
# define grid
p_grid <- seq(from = 0, to = 1, length.out = 1000)
# define prior
prior <- rep(x = 1, 1000)
# compute likelihood at each value in grid
likelihood1 <- dbinom(x = sum(boys_after_girls), size = length(boys_after_girls), prob = p_grid)
likelihood2 <- dbinom(x = sum(c(birth1, birth2)), size = length(c(birth1, birth2)), prob = p_grid)
# compute product of likelihood and prior
unstd.posterior1 <- likelihood1 * prior
unstd.posterior2 <- likelihood2 * prior
# standardize the posterior, so it sums to 1
posterior1 <- unstd.posterior1 / sum(unstd.posterior1)
posterior2 <- unstd.posterior2 / sum(unstd.posterior2)
samples1 <- sample(x = p_grid, size = 10000, prob = posterior1, replace = TRUE)
samples2 <- sample(x = p_grid, size = 10000, prob = posterior2, replace = TRUE)
posterior1 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples1)
posterior2 <- rbinom(n = 10000, size = length(boys_after_girls), prob = samples2)
hist(posterior1, col=rgb(0,0,1,1/4))
hist(posterior2, add=T, col=rgb(1,0,1,1/4))
abline(v = sum(boys_after_girls))
